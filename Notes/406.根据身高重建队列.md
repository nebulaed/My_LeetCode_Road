## 406.根据身高重建队列

### 方法一：从低到高考虑

当每个人身高都不同时，若按照身高从小到大进行排序，就能很方便地还原出原始队列。

设人数为$n$，进行排序后，身高依次为$h_0$,$h_1$,$\dots$,$h_{n-1}$，且排在第$i$个人前面身高大于$h_i$的人数为$k_i$。若按照排完序后的顺序，依次将每个人放入队列中，那么放入第$i$个人时：

- 第$0$,$\dots$，$i-1$个人已经在队列中安排了位置，并且无论他们站在哪里，对第$i$个人没有影响
- 而第$i+1$，$\dots$，$n-1$个人还没有放入队列中，但只要他们站在第$i$个人前面，就会对第$i$个人产生影响，因为它们比第$i$个人高

若在初始时建立一个包含$n$个位置的空队列，而每次将一个人放入队列中时，会将一个**空**位置变成**满**位置，那么当放入第$i$个人时，需要给他安排一个**空**位置，并且这个**空**位置前面恰好还有$k_i$个**空**位置，用来安排给后面身高更高的人。也就是说，**第$i$个人的位置，就是队列中从左往右数第$k_i+1$个空位置。**

如果有身高相同的人，上述$k_i$定义中的大于就与题目描述中要求的大于等于不等价了，需要修改：

若第$i$个人和第$j$个人的身高相同，即$h_i=h_j$，那么可以把在队列中处于较后位置的那个人身高减小一点点。即对于某一个身高值$h$，将队列中第一个身高为$h$的人保持不变，第二个身高为$h$的人身高减少$\delta$，第三个身高为$h$的人身高减少$2\delta$，以此类推，其中$\delta$是一个很小常数，使得任何身高为$h$的人不会与其它人的排序发生改变。

找到所有身高为$h$的人的方法：当$h_i=h_j$时，若$k_i>k_j$，那么$i$一定 相对于$j$在队列中处于较后的位置，按照修改后结果，$h_i$略小于$h_j$，第$i$个人在排序后应该先于第$j$个人被放入队列。因此，不必真的对身高进行修改，只需要按照**$h_i$为第一关键字升序**，**$k_i$为第二关键字降序进行排列**即可。此时，具有相同身高的人会按照它们在队列中的位置逆序进行排列，就间接实现了把身高减少$\delta$的效果。

### 方法二：从高到低考虑

若将每个人按照身高从大到小进行排序，处理身高相同的人使用的方法类似：**按照$h_i$为第一关键字降序，$k_i$为第二关键字升序进行排序。**若按照排完序的顺序，依次将每个人放入队列，当放入第$i$人时：

- 第$0, \dots, i-1$个人已经在队列中安排了位置，他们只要站在第$i$个人前面，就会对第$i$个人有影响；
- 第$i+1,\dots,n-1$个人还没有放入队列中，并且无论他们站在哪里，对第$i$个人都没有任何影响。

这时，后面的人无法对第$i$个人造成影响，因此可以采用**插空**的方法，依次给每一个人在当前队列中选择一个插入为止，也就是说，当放入第$i$个人时，只需要将其直接插入队列中，使他前面恰好有$k_i$个人即可。

